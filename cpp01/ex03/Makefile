.PHONY : all bonus clean fclean re

NAME := unnecessary_violence

# â•­â”â”â”â”â”â”â”â”â”â”â”â”â•â•â•â•â•â•â•â•â•â•â••å‡º â– BASICS VARIABLES â– åŠ›â•’â•â•â•â•â•â•â•â•â•â•â•â”â”â”â”â”â”â”â”â”â”â”â”â•® #

CXX				:=	c++

CXXFLAGS		:=	-Wall -Wextra -Werror -std=c++98

RM				:=	rm	-rf

MKDIR			:=	mkdir -p

SHOW_MSG_CLEAN	=	true

MAKEFLAGS		+=	--no-print-directory

# â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•›å‡º â– åŠ›â•˜â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯ #

# â•­â”â”â”â”â”â”â”â”â”â”â”â”â•â•â•â•â•â•â•â•â•â•â••å‡º â– FILE TREE â– åŠ›â•’â•â•â•â•â•â•â•â•â•â•â•â”â”â”â”â”â”â”â”â”â”â”â”â•® #

D_SRC		=	src/
D_INC		=	include/

D_OBJ		=	.objs/

# file lists
SRCS		=	$(addprefix $(D_SRC), HumanA.cpp HumanB.cpp Weapon.cpp main.cpp)
INCS		=	$(addprefix $(D_INC), HumanA.hpp HumanB.hpp Weapon.hpp)
OBJS		=	$(patsubst $(D_SRC)%.cpp,$(D_OBJ)%.o,$(SRCS))

INC			=	-I$(D_INC)

# â•­â”â”â”â”â”â”â”â”â”â”â”â”â•â•â•â•â•â•â•â•â•â•â••å‡º â– RULES â– åŠ›â•’â•â•â•â•â•â•â•â•â•â•â•â”â”â”â”â”â”â”â”â”â”â”â”â•® #

all:	$(NAME)

$(NAME):	$(OBJS) $(INCS) | Makefile $(D_OBJ)
	@$(CXX) $(CXXFLAGS) $(INC) $(OBJS) -o $(NAME)
	@echo "\e[1;32mğŸ $(NAME) program created successfully ! ğŸ\e[0m"

$(D_OBJ):
	@$(MKDIR) $(D_OBJ)

$(D_OBJ)%.o: $(D_SRC)%.cpp | Makefile $(D_OBJ)
	@echo "Compiling $<"
	@$(CXX) $(CXXFLAGS) $(INC) -c $< -o $@

clean:
	@$(RM) $(D_OBJ)
	@echo "\e[1;36mğŸ«— Deleted $(NAME) object files ğŸ«—\e[0m"

fclean:
	@$(MAKE) -s SHOW_MSG_CLEAN=false clean
	@$(RM) $(NAME)
	@echo "\e[1;34mğŸ§¼ $(NAME) executable deleted ! ğŸ§¼\e[0m"

re:
	@$(MAKE) fclean
	@$(MAKE) all

valgrind:
	@$(MAKE)
	@clear
	@valgrind										\
		--leak-check=full								\
		--show-leak-kinds=all							\
		--track-origins=yes 							\
		--track-fds=yes									\
		./$(NAME)
